<!DOCTYPE html> <!-- объявляем тип документа как HTML5 для совместимости с современными браузерами -->
<html lang="ru"> <!-- открываем корневой элемент HTML с указанием русского языка содержимого -->
<head> <!-- открываем секцию head для метаданных страницы и стилей -->
    <meta charset="UTF-8"> <!-- устанавливаем кодировку UTF-8 для корректного отображения русских символов и специальных знаков -->
    <title>{{ myapp.name }} - Курсы валют</title> <!-- задаём динамический заголовок вкладки браузера с названием приложения -->
    <style> /* открываем блок встроенных стилей CSS для оформления страницы */
        /* Блок стилей для всего тела документа */
        body { font-family: Arial, sans-serif; margin: 40px; } /* устанавливаем основной шрифт Arial с универсальным запасным вариантом и задаём внешние отступы по 40 пикселей со всех сторон страницы  */
        /* Блок стилей для блока навигации */
        .nav { margin: 20px 0; } /* устанавливаем вертикальные отступы в 20 пикселей сверху и снизу навигационного блока */
        /* Блок стилей для ссылок внутри навигации */
        .nav a { margin-right: 15px; text-decoration: none; color: #0066cc; } /* добавляем правый отступ в 15 пикселей для создания промежутков между ссылками, убираем стандартное подчёркивание у ссылок для чистого вида и задаём синий цвет текста ссылок */
        /* Блок стилей для ссылок при наведении курсора мыши */
        .nav a:hover { text-decoration: underline; } /* добавляем подчёркивание при наведении для визуальной обратной связи */
        /* Блок стилей для таблицы с курсами валют */
        table { border-collapse: collapse; width: 100%; margin: 20px 0; } /* объединяем границы соседних ячеек таблицы в единую линию, растягиваем таблицу на всю доступную ширину контейнера и добавляем вертикальные отступы в 20 пикселей сверху и снизу таблицы */
        /* Блок общих стилей для заголовочных и обычных ячеек таблицы */
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; } /* добавляем светло-серую рамку толщиной 1 пиксель вокруг каждой ячейки, задаём внутренние отступы в 12 пикселей для содержимого ячеек и выравниваем текст в ячейках по левому краю */
        /* Блок специфических стилей для заголовочных ячеек таблицы */
        th { background-color: #f2f2f2; } /* устанавливаем светло-серый фон для заголовков столбцов */
        /* Блок стилей для блока отображения ошибок */
        .error { 
            background-color: #fff5f5; /* устанавливаем светло-красный фон для блока ошибок */
            border: 1px solid #fed7d7; /* добавляем красную рамку толщиной 1 пиксель */
            border-radius: 5px; /* скругляем углы блока на 5 пикселей */
            padding: 20px; /* задаём внутренние отступы в 20 пикселей для содержимого блока */
            margin: 20px 0; /* добавляем вертикальные отступы в 20 пикселей сверху и снизу */
            color: #c53030; /* устанавливаем тёмно-красный цвет текста для сообщений об ошибках */
        }
        /* Блок стилей для информационного блока с уведомлениями */
        .info { 
            background-color: #ebf8ff; /* задаём светло-голубой фон для информационных сообщений */
            border: 1px solid #bee3f8; /* добавляем голубую рамку толщиной 1 пиксель */
            border-radius: 5px; /* скругляем углы блока на 5 пикселей */
            padding: 15px; /* устанавливаем внутренние отступы в 15 пикселей */
            margin: 20px 0; /* добавляем вертикальные отступы в 20 пикселей сверху и снизу */
            color: #2c5282; /* задаём тёмно-синий цвет текста для информационных сообщений */
        }
        /* Блок стилей для блока индикации загрузки данных */
        .loading {
            background-color: #f7fafc; /* устанавливаем светло-серый фон */
            border: 1px solid #e2e8f0; /* добавляем светло-серую рамку толщиной 1 пиксель */
            border-radius: 5px; /* скругляем углы блока на 5 пикселей */
            padding: 20px; /* задаём внутренние отступы в 20 пикселей */
            margin: 20px 0; /* добавляем вертикальные отступы в 20 пикселей сверху и снизу */
            text-align: center; /* центрируем текст по горизонтали внутри блока */
            color: #4a5568; /* устанавливаем серо-синий цвет текста */
        }
    </style> <!-- закрываем блок встроенных стилей -->
</head> <!-- закрываем секцию head -->
<body> <!-- открываем тело документа, где размещается видимое содержимое страницы -->
    <h1>{{ myapp.name }}</h1> <!-- задаём заголовок первого уровня с динамическим названием приложения -->
    
    <div class="nav"> <!-- открываем блок навигации по сайту -->
        <a href="/">Главная</a> <!-- задаём ссылку для перехода на главную страницу приложения -->
        <a href="/users">Пользователи</a> <!-- задаём ссылку для перехода на страницу управления пользователями -->
        <a href="/currencies">Курсы валют</a> <!-- задаём ссылку на текущую страницу (активная) -->
        <a href="/author">Об авторе</a> <!-- задаём ссылку для перехода на страницу с информацией об авторе -->
    </div> <!-- закрываем блок навигации -->
    
    <h2>Курсы валют</h2> <!-- задаём заголовок второго уровня, обозначающий содержание страницы -->
    
    <!-- 
        Блок условного отображения с использованием Jinja2
        Проверяем три возможных состояния: ошибка API, успешная загрузка, загрузка данных
    -->
    {% if api_error %} <!-- проверяем, установлена ли переменная api_error (при ошибке загрузки данных) -->
    <div class="error"> <!-- открываем блок для отображения сообщения об ошибке -->
        <h3>Ошибка загрузки данных</h3> <!-- задаём заголовок третьего уровня для сообщения об ошибке -->
        <p>{{ api_error }}</p> <!-- задаём параграф с динамическим описанием ошибки из переменной шаблона -->
        <p>Данные о курсах валют временно недоступны.</p> <!-- задаём статическое поясняющее сообщение для пользователя -->
    </div> <!-- закрываем блок ошибки -->
    {% elif currencies %} <!-- в противном случае проверяем, есть ли данные о валютах -->
    <div class="info"> <!-- открываем информационный блок с деталями о загруженных данных -->
        <h4>Данные загружены с сайта ЦБ РФ</h4> <!-- задаём заголовок четвёртого уровня с источником данных -->
        <p>Все валюты ({{ currencies|length }}):</p> <!-- задаём параграф с количеством загруженных валют через фильтр length -->
    </div> <!-- закрываем информационный блок -->

    <table> <!-- открываем таблицу для отображения списка валют -->
        <thead> <!-- открываем секцию заголовка таблицы -->
            <tr> <!-- открываем строку заголовков столбцов -->
                <th>Код</th> <!-- задаём заголовок столбца с буквенным кодом валюты -->
                <th>Цифровой код</th> <!-- задаём заголовок столбца с цифровым кодом валюты -->
                <th>Название</th> <!-- задаём заголовок столбца с названием валюты -->
                <th>Курс к рублю</th> <!-- задаём заголовок столбца с курсом валюты к российскому рублю -->
                <th>Номинал</th> <!-- задаём заголовок столбца с номиналом валюты -->
            </tr> <!-- закрываем строку заголовков -->
        </thead> <!-- закрываем секцию заголовка таблицы -->
        <tbody> <!-- открываем секцию тела таблицы с данными -->
            {% for currency in currencies %} <!-- открываем цикл Jinja2 для перебора всех валют -->
            <tr> <!-- открываем строку таблицы для одной валюты -->
                <td>{{ currency.char_code }}</td> <!-- задаём ячейку с буквенным кодом валюты -->
                <td>{{ currency.num_code }}</td> <!-- задаём ячейку с цифровым кодом валюты -->
                <td>{{ currency.name }}</td> <!-- задаём ячейку с полным названием валюты -->
                <td>{{ currency.value }} руб.</td> <!-- задаём ячейку с курсом валюты к рублю с указанием единицы измерения -->
                <td>{{ currency.nominal }}</td> <!-- задаём ячейку с номиналом валюты -->
            </tr> <!-- закрываем строку таблицы для текущей валюты -->
            {% endfor %} <!-- закрываем цикл перебора валют -->
        </tbody> <!-- закрываем секцию тела таблицы -->
    </table> <!-- закрываем таблицу -->
    
    {% else %} <!-- в противном случае -->
    <div class="loading"> <!-- открываем блок индикации загрузки данных -->
        <h3>Загрузка данных...</h3> <!-- задаём заголовок третьего уровня с сообщением о процессе загрузки -->
        <p>Пожалуйста, подождите, данные загружаются с сайта ЦБ РФ.</p> <!-- задаём поясняющее сообщение для пользователя -->
    </div> <!-- закрываем блок индикации загрузки -->

    {% endif %} <!-- закрываем блок условного отображения Jinja2 -->
    
    <div style="margin-top: 30px;"> <!-- открываем блок с встроенным стилем для отступа сверху -->
        <a href="/">Вернуться на главную</a> <!-- задаём ссылку для возврата на главную страницу приложения -->
    </div> <!-- закрываем блок с ссылкой возврата -->
</body> <!-- закрываем тело документа -->
</html> <!-- закрываем корневой элемент HTML -->